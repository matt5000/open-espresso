<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 500" width="900" height="500">
  <style>
    text { font-family: 'Source Sans 3', sans-serif; }
    .mono { font-family: 'Source Code Pro', monospace; }
  </style>

  <defs>
    <marker id="arrow-data" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="none" stroke="#3b82f6" stroke-width="1.5"/>
    </marker>
    <marker id="arrow-struct" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="none" stroke="#64748b" stroke-width="1.5"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="900" height="500" fill="#f8fafc" rx="4"/>

  <!-- Title -->
  <text x="450" y="28" text-anchor="middle" fill="#0f172a" font-size="16" font-weight="bold">Display + Web UI Architecture</text>

  <!-- ESP32-S3 outer box -->
  <rect x="30" y="42" width="440" height="250" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
  <text x="250" y="64" text-anchor="middle" fill="#0f172a" font-size="14" font-weight="bold">ESP32-S3</text>
  <line x1="50" y1="72" x2="450" y2="72" stroke="#e2e8f0" stroke-width="1"/>

  <!-- Control (Core 0) box -->
  <rect x="50" y="82" width="190" height="68" rx="6" fill="#dbeafe" stroke="#1e40af" stroke-width="2"/>
  <text x="145" y="103" text-anchor="middle" fill="#1e40af" font-size="13" font-weight="bold">Control (Core 0)</text>
  <text x="145" y="121" text-anchor="middle" fill="#1e40af" font-size="11">PID, Sensors, Pump</text>
  <text x="145" y="137" text-anchor="middle" fill="#1e40af" font-size="11">Safety, Dimmer</text>

  <!-- UI + Web (Core 1) box -->
  <rect x="50" y="168" width="190" height="68" rx="6" fill="white" stroke="#334155" stroke-width="1.5"/>
  <text x="145" y="189" text-anchor="middle" fill="#0f172a" font-size="13" font-weight="bold">UI + Web (Core 1)</text>
  <text x="145" y="207" text-anchor="middle" fill="#0f172a" font-size="11">LVGL rendering</text>
  <text x="145" y="223" text-anchor="middle" fill="#0f172a" font-size="11">HTTP + WebSocket server</text>

  <!-- Web App / LittleFS box -->
  <rect x="260" y="168" width="190" height="68" rx="6" fill="white" stroke="#334155" stroke-width="1.5"/>
  <text x="355" y="189" text-anchor="middle" fill="#0f172a" font-size="13" font-weight="bold">Web App (LittleFS)</text>
  <text x="355" y="207" text-anchor="middle" fill="#0f172a" font-size="11">HTML / CSS / JS</text>
  <text x="355" y="223" text-anchor="middle" fill="#0f172a" font-size="11">Served from flash</text>

  <!-- Arrow: Core 1 -> Web App -->
  <line x1="240" y1="202" x2="260" y2="202" stroke="#3b82f6" stroke-width="1.5" marker-end="url(#arrow-data)"/>

  <!-- ILI9341 TFT Display box -->
  <rect x="530" y="42" width="340" height="205" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
  <text x="700" y="64" text-anchor="middle" fill="#0f172a" font-size="14" font-weight="bold">ILI9341 TFT + CST816 Touch</text>
  <line x1="550" y1="72" x2="850" y2="72" stroke="#e2e8f0" stroke-width="1"/>

  <!-- Display content items -->
  <text x="560" y="95" fill="#0f172a" font-size="12">Shot Information:</text>
  <rect x="555" y="104" width="140" height="28" rx="4" fill="#dbeafe" stroke="#1e40af" stroke-width="1"/>
  <text x="625" y="123" text-anchor="middle" fill="#1e40af" font-size="12">Temperature</text>
  <rect x="705" y="104" width="140" height="28" rx="4" fill="#dbeafe" stroke="#1e40af" stroke-width="1"/>
  <text x="775" y="123" text-anchor="middle" fill="#1e40af" font-size="12">Pressure Graph</text>

  <rect x="555" y="140" width="140" height="28" rx="4" fill="#dbeafe" stroke="#1e40af" stroke-width="1"/>
  <text x="625" y="159" text-anchor="middle" fill="#1e40af" font-size="12">Flow Rate</text>
  <rect x="705" y="140" width="140" height="28" rx="4" fill="#dbeafe" stroke="#1e40af" stroke-width="1"/>
  <text x="775" y="159" text-anchor="middle" fill="#1e40af" font-size="12">Shot Timer</text>

  <rect x="555" y="176" width="140" height="28" rx="4" fill="#dbeafe" stroke="#1e40af" stroke-width="1"/>
  <text x="625" y="195" text-anchor="middle" fill="#1e40af" font-size="12">Weight</text>
  <rect x="705" y="176" width="140" height="28" rx="4" fill="#dbeafe" stroke="#1e40af" stroke-width="1"/>
  <text x="775" y="195" text-anchor="middle" fill="#1e40af" font-size="12">Phase Indicator</text>

  <!-- SPI arrow: Control -> TFT -->
  <line x1="240" y1="106" x2="530" y2="106" stroke="#3b82f6" stroke-width="1.5" marker-end="url(#arrow-data)"/>
  <rect x="340" y="90" width="60" height="22" rx="3" fill="#f8fafc"/>
  <text x="370" y="105" text-anchor="middle" class="mono" fill="#3b82f6" font-size="11" font-weight="bold">SPI</text>

  <!-- Arrow: Core 1 -> TFT (LVGL) -->
  <line x1="240" y1="186" x2="485" y2="186" stroke="#3b82f6" stroke-width="1.5"/>
  <line x1="485" y1="186" x2="485" y2="135" stroke="#3b82f6" stroke-width="1.5"/>
  <line x1="485" y1="135" x2="530" y2="135" stroke="#3b82f6" stroke-width="1.5" marker-end="url(#arrow-data)"/>
  <rect x="455" y="146" width="55" height="20" rx="3" fill="#f8fafc"/>
  <text x="483" y="160" text-anchor="middle" fill="#3b82f6" font-size="10">LVGL</text>

  <!-- Phone/Tablet/Laptop box -->
  <rect x="530" y="290" width="340" height="195" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
  <text x="700" y="315" text-anchor="middle" fill="#0f172a" font-size="14" font-weight="bold">Phone / Tablet / Laptop</text>
  <line x1="550" y1="324" x2="850" y2="324" stroke="#e2e8f0" stroke-width="1"/>

  <!-- Client features -->
  <text x="570" y="345" fill="#0f172a" font-size="12">Profile editor</text>
  <text x="570" y="367" fill="#0f172a" font-size="12">Shot history</text>
  <text x="570" y="389" fill="#0f172a" font-size="12">PID tuning</text>
  <text x="730" y="345" fill="#0f172a" font-size="12">System settings</text>
  <text x="730" y="367" fill="#0f172a" font-size="12">Real-time monitoring</text>
  <text x="730" y="389" fill="#0f172a" font-size="12">OTA update</text>

  <!-- WiFi arrow: Web App -> Phone -->
  <line x1="355" y1="236" x2="355" y2="387" stroke="#3b82f6" stroke-width="1.5"/>
  <line x1="355" y1="387" x2="530" y2="387" stroke="#3b82f6" stroke-width="1.5" marker-end="url(#arrow-data)"/>

  <!-- WiFi label -->
  <rect x="368" y="300" width="150" height="42" rx="5" fill="#f8fafc" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="4,3"/>
  <text x="443" y="317" text-anchor="middle" fill="#3b82f6" font-size="12" font-weight="bold">WiFi</text>
  <text x="443" y="334" text-anchor="middle" class="mono" fill="#3b82f6" font-size="10">HTTP + WebSocket</text>

  <!-- Data flow legend -->
  <rect x="30" y="310" width="180" height="55" rx="4" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1"/>
  <text x="45" y="328" fill="#64748b" font-size="11" font-weight="bold">Legend</text>
  <line x1="45" y1="345" x2="85" y2="345" stroke="#3b82f6" stroke-width="1.5" marker-end="url(#arrow-data)"/>
  <text x="95" y="349" fill="#64748b" font-size="11">Data flow</text>
</svg>
