<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 620 340" width="620" height="340">
  <style>
    text { font-family: 'Source Sans 3', sans-serif; }
    .mono { font-family: 'Source Code Pro', monospace; font-size: 12px; }
  </style>
  <rect width="620" height="340" fill="#f8fafc" rx="4"/>
  <text x="310" y="26" text-anchor="middle" fill="#0f172a" font-size="16" font-weight="bold">ESP32 Software Architecture (Current UI Side)</text>
  <!-- Root -->
  <rect x="20" y="42" width="280" height="30" rx="5" fill="#dbeafe" stroke="#1e40af" stroke-width="2"/>
  <text x="160" y="62" text-anchor="middle" class="mono" fill="#1e40af" font-weight="bold">Main Loop (esp_comms.cpp)</text>
  <!-- Trunk -->
  <line x1="40" y1="72" x2="40" y2="310" stroke="#64748b" stroke-width="1.5"/>
  <!-- UART -->
  <circle cx="40" cy="95" r="3" fill="#64748b"/>
  <line x1="40" y1="95" x2="70" y2="95" stroke="#64748b" stroke-width="1.5"/>
  <rect x="70" y="80" width="220" height="30" rx="5" fill="white" stroke="#334155" stroke-width="1.5"/>
  <text x="180" y="100" text-anchor="middle" class="mono" fill="#0f172a">UART receive/transmit</text>
  <text x="310" y="100" fill="#64748b" font-size="11">Communication with STM32</text>
  <!-- Display -->
  <circle cx="40" cy="140" r="3" fill="#64748b"/>
  <line x1="40" y1="140" x2="70" y2="140" stroke="#64748b" stroke-width="1.5"/>
  <rect x="70" y="125" width="220" height="30" rx="5" fill="white" stroke="#334155" stroke-width="1.5"/>
  <text x="180" y="145" text-anchor="middle" class="mono" fill="#0f172a">Display (Nextion)</text>
  <line x1="290" y1="140" x2="310" y2="140" stroke="#64748b" stroke-width="1"/>
  <line x1="310" y1="125" x2="310" y2="168" stroke="#64748b" stroke-width="1"/>
  <line x1="310" y1="125" x2="330" y2="125" stroke="#64748b" stroke-width="1"/>
  <text x="340" y="129" fill="#64748b" font-size="11">Page navigation</text>
  <line x1="310" y1="143" x2="330" y2="143" stroke="#64748b" stroke-width="1"/>
  <text x="340" y="147" fill="#64748b" font-size="11">Profile editing UI</text>
  <line x1="310" y1="161" x2="330" y2="161" stroke="#64748b" stroke-width="1"/>
  <text x="340" y="165" fill="#64748b" font-size="11">Shot graph rendering</text>
  <!-- BLE Scales -->
  <circle cx="40" cy="195" r="3" fill="#64748b"/>
  <line x1="40" y1="195" x2="70" y2="195" stroke="#64748b" stroke-width="1.5"/>
  <rect x="70" y="180" width="220" height="30" rx="5" fill="white" stroke="#334155" stroke-width="1.5"/>
  <text x="180" y="200" text-anchor="middle" class="mono" fill="#0f172a">BLE Scales</text>
  <line x1="290" y1="195" x2="310" y2="195" stroke="#64748b" stroke-width="1"/>
  <line x1="310" y1="180" x2="310" y2="238" stroke="#64748b" stroke-width="1"/>
  <line x1="310" y1="180" x2="330" y2="180" stroke="#64748b" stroke-width="1"/>
  <text x="340" y="184" fill="#64748b" font-size="11">Acaia</text>
  <line x1="310" y1="196" x2="330" y2="196" stroke="#64748b" stroke-width="1"/>
  <text x="340" y="200" fill="#64748b" font-size="11">Felicita</text>
  <line x1="310" y1="212" x2="330" y2="212" stroke="#64748b" stroke-width="1"/>
  <text x="340" y="216" fill="#64748b" font-size="11">Decent</text>
  <line x1="310" y1="228" x2="330" y2="228" stroke="#64748b" stroke-width="1"/>
  <text x="340" y="232" fill="#64748b" font-size="11">Bookoo (multiple models)</text>
  <!-- EEPROM -->
  <circle cx="40" cy="260" r="3" fill="#64748b"/>
  <line x1="40" y1="260" x2="70" y2="260" stroke="#64748b" stroke-width="1.5"/>
  <rect x="70" y="245" width="220" height="30" rx="5" fill="white" stroke="#334155" stroke-width="1.5"/>
  <text x="180" y="265" text-anchor="middle" class="mono" fill="#0f172a">EEPROM Management</text>
  <text x="310" y="265" fill="#64748b" font-size="11">eepromValues_t struct</text>
  <!-- Web OTA -->
  <circle cx="40" cy="305" r="3" fill="#64748b"/>
  <line x1="40" y1="305" x2="70" y2="305" stroke="#64748b" stroke-width="1.5"/>
  <rect x="70" y="290" width="220" height="30" rx="5" fill="white" stroke="#334155" stroke-width="1.5"/>
  <text x="180" y="310" text-anchor="middle" class="mono" fill="#0f172a">Web OTA</text>
  <text x="310" y="310" fill="#64748b" font-size="11">Over-the-air firmware update</text>
</svg>
